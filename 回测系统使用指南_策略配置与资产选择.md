# 回测系统使用指南：策略配置与资产选择

## 概述

FactorWeave-Quant专业回测系统提供了灵活的策略配置和资产选择功能。本指南将详细说明如何正确配置和使用回测系统，包括策略选择、参数设置、资产配置以及结果解读。

## 一、系统支持的主要策略类型

### 1. 复权价格动量策略（AdjPriceMomentumStrategy）
- **策略说明**：基于复权价格计算真实动量，选择动量最强的股票
- **关键参数**：
  - 动量计算周期（lookback_period）：默认为20天
  - 选择股票数量（top_n）：默认为10只
- **适用场景**：适合趋势跟踪，能够捕捉强势股票的中短期动量

### 2. VWAP均值回归策略（VWAPMeanReversionStrategy）
- **策略说明**：基于VWAP（成交量加权平均价格）进行均值回归交易
- **关键参数**：
  - 偏离阈值（deviation_threshold）：默认为2%
  - 持有周期（hold_period）：默认为3天
  - 最小换手率（min_turnover_rate）：默认为0.5%
- **适用场景**：适合震荡市场，能够捕捉价格偏离VWAP后的回归机会

## 二、策略配置流程

### 步骤1：打开策略管理对话框
1. 在主界面中，点击"策略管理"菜单
2. 或在回测界面中点击"策略配置"按钮
3. 系统将打开策略管理对话框，包含以下选项卡：
   - 策略列表：显示所有已配置的策略
   - 创建策略：配置新策略参数
   - 回测：执行策略回测
   - 优化：优化策略参数

### 步骤2：选择或创建策略
1. 在策略列表选项卡中，您可以：
   - 查看已配置的策略列表
   - 点击策略名称查看详细信息
   - 点击"编辑"修改策略参数

2. 如需创建新策略：
   - 点击"创建策略"选项卡
   - 从下拉菜单选择策略类型（如"复权价格动量策略"）
   - 配置策略参数（周期、股票数量等）
   - 点击"保存"按钮保存策略

### 步骤3：配置策略参数
1. **参数配置区域**：
   - 策略类型：选择策略类型
   - 周期设置：设置动量计算周期（如20天）
   - 选股数量：设置选择的股票数量（如前10只）

2. **股票列表**：
   - 手动输入股票代码，格式为"代码1,代码2,代码3"
   - 示例：000001,600519,000858
   - 或点击"浏览"按钮选择预定义的股票组合

3. **其他参数**：
   - 开始日期：设置回测开始日期
   - 结束日期：设置回测结束日期
   - 初始资金：设置初始投资金额

### 步骤4：执行回测
1. 配置完成后，点击"开始回测"按钮
2. 系统将显示回测进度：
   - 实时显示当前回测进度
   - 显示已处理的数据量
   - 显示当前处理的股票

3. 回测过程中可以：
   - 暂停回测
   - 终止回测
   - 查看实时日志

## 三、资产数据来源与选择

### 1. 数据来源
系统使用统一数据管理器（UnifiedDataManager）获取数据，主要来源包括：
- **历史K线数据**：包含开高低收、成交量、成交额等
- **技术指标数据**：各类技术指标计算结果
- **基本面数据**：财务指标、公司信息等
- **衍生数据**：复权价格、VWAP等计算衍生数据

### 2. 资产类型
系统支持多种资产类型：
- **A股股票**：以股票代码标识，如000001、600519
- **指数**：如沪深300、中证500等指数
- **ETF**：交易型开放式指数基金

### 3. 数据周期
支持多种数据周期：
- **日线数据**（D）：适用于中短期策略
- **周线数据**（W）：适用于中期策略
- **月线数据**（M）：适用于长期策略
- **分钟数据**（min）：适用于超短线策略

## 四、回测结果解读

### 1. 主要指标
回测完成后，系统将显示以下关键指标：

- **总收益率**：策略总收益百分比
- **年化收益率**：年化后的收益率
- **夏普比率**：衡量风险调整后收益的指标
- **最大回撤**：最大亏损幅度
- **胜率**：盈利交易占比
- **盈亏比**：平均盈利与平均亏损的比值

### 2. 图表显示
- **收益曲线**：显示策略累计收益随时间变化
- **基准对比**：与基准指数（如沪深300）的对比
- **回撤曲线**：显示策略的最大回撤情况
- **持仓分析**：显示不同时期的持仓情况

### 3. 交易记录
- **交易明细**：显示每笔交易的日期、价格、数量
- **持仓历史**：显示不同时期的持仓情况
- **收益分解**：将总收益分解为各股票的贡献

## 五、常见问题与解决方案

### 1. 为什么回测后UI没有更新？
- 检查日志是否有错误信息
- 确认监控线程是否正常启动
- 检查数据是否正确加载
- 验证UI更新机制是否正常工作

### 2. 如何选择合适的策略？
- 根据市场环境选择策略类型
  - 趋势市场：选择动量策略
  - 震荡市场：选择均值回归策略
- 根据投资周期选择策略
  - 短线：选择反应快速的策略
  - 长线：选择稳定收益的策略

### 3. 如何解读回测结果？
- 综合考虑多个指标，不要仅看总收益率
- 关注风险指标，如最大回撤和夏普比率
- 对比基准指数，评估超额收益
- 分析交易记录，了解策略的盈利模式

## 六、最佳实践建议

1. **策略开发流程**：
   - 先进行单股票测试
   - 再进行多股票组合测试
   - 最后进行全市场测试
   - 注意样本外测试

2. **参数优化**：
   - 避免过度优化
   - 使用交叉验证
   - 关注参数的稳健性
   - 考虑交易成本影响

3. **风险管理**：
   - 设置止损点
   - 控制单股仓位
   - 定期调整策略
   - 关注市场环境变化

## 七、技术支持

如果您在使用过程中遇到问题，可以：
1. 查看系统日志获取详细错误信息
2. 联系技术支持团队
3. 参考系统文档和示例策略
4. 参与用户社区讨论

---

本指南提供了回测系统策略配置和资产选择的基本使用方法。系统功能丰富，建议根据实际需求深入探索各个功能模块。