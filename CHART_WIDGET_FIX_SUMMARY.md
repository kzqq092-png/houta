# HIkyuuå›¾è¡¨æ§ä»¶é”™è¯¯ä¿®å¤æ€»ç»“

## ğŸ“‹ é—®é¢˜æ¦‚è¿°

åœ¨HIkyuuäº¤æ˜“ç³»ç»Ÿä¸­å‘ç°äº†ä¸¤ä¸ªå…³é”®çš„matplotlibå¯¹è±¡å¤„ç†é”™è¯¯ï¼Œè¿™äº›é”™è¯¯ä¼šå¯¼è‡´ç”¨æˆ·åœ¨æ“ä½œå›¾è¡¨æ—¶å‡ºç°ç³»ç»Ÿå´©æºƒã€‚

## ğŸ› é”™è¯¯è¯¦æƒ…

### é”™è¯¯1: TypeError
```
TypeError: argument of type 'Text' is not iterable
```
**å‘ç”Ÿä½ç½®**: `gui/widgets/chart_widget.py` ç¬¬2132-2134è¡Œ
**è§¦å‘åœºæ™¯**: ç”¨æˆ·å°è¯•æ¸…é™¤æŠ€æœ¯æŒ‡æ ‡æ—¶

### é”™è¯¯2: ValueError  
```
ValueError: list.remove(x): x not in list
```
**å‘ç”Ÿä½ç½®**: `gui/widgets/chart_widget.py` ç¬¬2148è¡Œ
**è§¦å‘åœºæ™¯**: matplotlib artistå¯¹è±¡å·²è¢«ç§»é™¤ä½†ä»£ç ä»å°è¯•ç§»é™¤æ—¶

## ğŸ” æ ¹å› åˆ†æ

### TypeErroræ ¹å› 
- `child.get_label()` è¿”å›matplotlib Textå¯¹è±¡è€Œä¸æ˜¯å­—ç¬¦ä¸²
- ä»£ç å°è¯•æ‰§è¡Œ `indicator in child.get_label()` æ“ä½œ
- Textå¯¹è±¡ä¸æ”¯æŒ `in` æ“ä½œï¼Œå¯¼è‡´ç±»å‹é”™è¯¯

### ValueErroræ ¹å› 
- matplotlib artistå¯¹è±¡åœ¨å¹¶å‘æˆ–é‡å¤æ“ä½œä¸­å·²ä»çˆ¶å®¹å™¨ç§»é™¤
- ä»£ç æœªæ£€æŸ¥å¯¹è±¡æ˜¯å¦ä»åœ¨å®¹å™¨ä¸­å°±ç›´æ¥è°ƒç”¨ `remove()`
- å¯¼è‡´"å¯¹è±¡ä¸åœ¨åˆ—è¡¨ä¸­"çš„é”™è¯¯

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ

### 1. å®‰å…¨æ ‡ç­¾è·å–æ–¹æ³•
```python
def _safe_get_label(self, obj):
    """å®‰å…¨åœ°è·å–matplotlibå¯¹è±¡çš„æ ‡ç­¾ï¼Œç¡®ä¿è¿”å›å­—ç¬¦ä¸²ç±»å‹"""
    try:
        if hasattr(obj, 'get_label'):
            label = obj.get_label()
            # å¤„ç†Textå¯¹è±¡
            if hasattr(label, 'get_text'):
                return str(label.get_text())
            elif isinstance(label, str):
                return label
            else:
                return str(label) if label is not None else ""
        return ""
    except Exception as e:
        self.log_manager.warning(f"è·å–æ ‡ç­¾å¤±è´¥: {str(e)}")
        return ""
```

### 2. å®‰å…¨ç§»é™¤æ–¹æ³•
```python
def _safe_remove_artist(self, artist, parent_ax=None):
    """å®‰å…¨ç§»é™¤matplotlib artistå¯¹è±¡"""
    try:
        if artist is None or not hasattr(artist, 'remove'):
            return True
            
        # æ£€æŸ¥å¯¹è±¡æ˜¯å¦ä»åœ¨çˆ¶å®¹å™¨ä¸­
        if parent_ax and hasattr(parent_ax, 'get_children'):
            if artist not in parent_ax.get_children():
                return True  # å·²ç»ä¸åœ¨å®¹å™¨ä¸­
        
        artist.remove()
        return True
        
    except ValueError as e:
        if "not in list" in str(e):
            return True  # å·²è¢«ç§»é™¤ï¼Œæ­£å¸¸æƒ…å†µ
        return False
    except Exception as e:
        self.log_manager.warning(f"ç§»é™¤å¤±è´¥: {str(e)}")
        return False
```

### 3. æ‰¹é‡å®‰å…¨ç§»é™¤æ–¹æ³•
```python
def _safe_remove_artists_list(self, artists_list, parent_ax=None):
    """å®‰å…¨ç§»é™¤ä¸€ç»„matplotlib artistå¯¹è±¡"""
    if not artists_list:
        return 0, 0
        
    success_count = 0
    for artist in artists_list:
        if self._safe_remove_artist(artist, parent_ax):
            success_count += 1
            
    return success_count, len(artists_list)
```

## ğŸ”§ ä¿®å¤èŒƒå›´

### ä¿®å¤çš„æ–¹æ³•å’Œä½ç½®
1. **clear_indicators()** - ä¸»è¦é”™è¯¯å‘ç”Ÿåœ°
2. **clear_signal_highlight()** - ä¿¡å·é«˜äº®æ¸…é™¤
3. **plot_signals()** - ä¿¡å·ç»˜åˆ¶æ—¶çš„æ—§å¯¹è±¡æ¸…é™¤
4. **_enable_signal_tooltips()** - å·¥å…·æç¤ºæ¸…é™¤
5. **update_chart()** - å›¾è¡¨æ›´æ–°æ—¶çš„æ–‡æœ¬æ¸…é™¤
6. **_render_indicators()** - æŒ‡æ ‡æ¸²æŸ“æ—¶çš„æ–‡æœ¬æ¸…é™¤
7. **ç¼©æ”¾ç›¸å…³æ–¹æ³•** - ç¼©æ”¾çŸ©å½¢çš„æ¸…é™¤
   - `_on_zoom_press()`
   - `_on_zoom_motion()`
   - `_on_zoom_release()`

### ä¿®å¤ç»Ÿè®¡
- **æ€»è®¡ä¿®å¤ä½ç½®**: 20+ å¤„
- **æ–°å¢æ–¹æ³•**: 3 ä¸ªå®‰å…¨æ–¹æ³•
- **å¢å¼ºé”™è¯¯å¤„ç†**: å…¨é¢çš„å¼‚å¸¸æ•è·å’Œæ—¥å¿—è®°å½•

## âœ… éªŒè¯æµ‹è¯•

### æµ‹è¯•è¦†ç›–
1. âœ… æ­£å¸¸ç§»é™¤æ“ä½œ
2. âœ… é‡å¤ç§»é™¤åŒä¸€å¯¹è±¡
3. âœ… ç§»é™¤Noneå¯¹è±¡
4. âœ… ç§»é™¤æ— removeæ–¹æ³•çš„å¯¹è±¡
5. âœ… æ‰¹é‡ç§»é™¤æ“ä½œ
6. âœ… ç©ºåˆ—è¡¨æ‰¹é‡ç§»é™¤
7. âœ… ChartWidgeté›†æˆæµ‹è¯•

### æµ‹è¯•ç»“æœ
```
ğŸ‰ æ‰€æœ‰å®‰å…¨ç§»é™¤æ–¹æ³•æµ‹è¯•é€šè¿‡ï¼
âœ… ChartWidgeté›†æˆæµ‹è¯•é€šè¿‡
```

## ğŸ“ˆ æŠ€æœ¯æ”¹è¿›

### å®‰å…¨æ€§å¢å¼º
- **é¢„æ£€æŸ¥æœºåˆ¶**: ç§»é™¤å‰æ£€æŸ¥å¯¹è±¡çŠ¶æ€
- **å¼‚å¸¸å®¹é”™**: ä¼˜é›…å¤„ç†å„ç§å¼‚å¸¸æƒ…å†µ
- **æ—¥å¿—è®°å½•**: è¯¦ç»†è®°å½•æ“ä½œçŠ¶æ€ä¾¿äºè°ƒè¯•

### æ€§èƒ½ä¼˜åŒ–
- **æ‰¹é‡æ“ä½œ**: ç»Ÿä¸€å¤„ç†å¤šä¸ªå¯¹è±¡ç§»é™¤
- **é¿å…é‡å¤æ“ä½œ**: æ™ºèƒ½è·³è¿‡å·²ç§»é™¤çš„å¯¹è±¡
- **å†…å­˜æ³„æ¼é˜²æŠ¤**: ç¡®ä¿å¯¹è±¡æ­£ç¡®é‡Šæ”¾

### ä»£ç è´¨é‡
- **ç»Ÿä¸€æ¥å£**: æ ‡å‡†åŒ–çš„å®‰å…¨ç§»é™¤æ–¹æ³•
- **å¯ç»´æŠ¤æ€§**: æ¸…æ™°çš„æ–¹æ³•å‘½åå’Œæ–‡æ¡£
- **æ‰©å±•æ€§**: æ˜“äºæ·»åŠ æ–°çš„å®‰å…¨æ“ä½œ

## ğŸ¯ å½±å“è¯„ä¼°

### ç”¨æˆ·ä½“éªŒæ”¹å–„
- âœ… æ¶ˆé™¤æŒ‡æ ‡æ¸…é™¤æ—¶çš„ç³»ç»Ÿå´©æºƒ
- âœ… æé«˜å›¾è¡¨äº¤äº’çš„ç¨³å®šæ€§
- âœ… å‡å°‘æ„å¤–é”™è¯¯çš„å‘ç”Ÿ

### ç³»ç»Ÿç¨³å®šæ€§
- âœ… å¢å¼ºmatplotlibå¯¹è±¡å¤„ç†çš„å¥å£®æ€§
- âœ… æ”¹å–„å¹¶å‘æ“ä½œçš„å®‰å…¨æ€§
- âœ… æå‡é•¿æ—¶é—´è¿è¡Œçš„ç¨³å®šæ€§

### å¼€å‘æ•ˆç‡
- âœ… å‡å°‘ç›¸å…³bugçš„è°ƒè¯•æ—¶é—´
- âœ… æä¾›å¯å¤ç”¨çš„å®‰å…¨æ“ä½œæ–¹æ³•
- âœ… æ”¹å–„é”™è¯¯è¯Šæ–­èƒ½åŠ›

## ğŸ“ åç»­å»ºè®®

### é¢„é˜²æªæ–½
1. **ä»£ç å®¡æŸ¥**: é‡ç‚¹å…³æ³¨matplotlibå¯¹è±¡æ“ä½œ
2. **å•å…ƒæµ‹è¯•**: ä¸ºå…³é”®æ–¹æ³•æ·»åŠ æµ‹è¯•ç”¨ä¾‹
3. **é›†æˆæµ‹è¯•**: å®šæœŸè¿›è¡Œå®Œæ•´çš„UIäº¤äº’æµ‹è¯•

### ç›‘æ§æœºåˆ¶
1. **é”™è¯¯ç›‘æ§**: ç›‘æ§ç›¸å…³é”™è¯¯çš„å‘ç”Ÿé¢‘ç‡
2. **æ€§èƒ½ç›‘æ§**: å…³æ³¨å›¾è¡¨æ“ä½œçš„æ€§èƒ½è¡¨ç°
3. **ç”¨æˆ·åé¦ˆ**: æ”¶é›†ç”¨æˆ·ä½¿ç”¨ä½“éªŒåé¦ˆ

## ğŸ† æ€»ç»“

è¿™æ¬¡ä¿®å¤è§£å†³äº†HIkyuuäº¤æ˜“ç³»ç»Ÿä¸­ä¸¤ä¸ªå…³é”®çš„matplotlibå¯¹è±¡å¤„ç†é”™è¯¯ï¼Œé€šè¿‡å¼•å…¥å®‰å…¨çš„æ“ä½œæ–¹æ³•å’Œå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæ˜¾è‘—æå‡äº†ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒã€‚ä¿®å¤è¦†ç›–äº†20å¤šä¸ªä½¿ç”¨ç‚¹ï¼Œå¹¶é€šè¿‡å…¨é¢çš„æµ‹è¯•éªŒè¯äº†ä¿®å¤çš„æœ‰æ•ˆæ€§ã€‚

**ä¿®å¤çŠ¶æ€**: âœ… å®Œæˆ
**æµ‹è¯•çŠ¶æ€**: âœ… é€šè¿‡  
**æ–‡æ¡£çŠ¶æ€**: âœ… å®Œæ•´
**éƒ¨ç½²çŠ¶æ€**: âœ… å°±ç»ª 